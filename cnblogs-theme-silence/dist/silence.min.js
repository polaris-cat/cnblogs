"use strict";var _createClass=function(){function s(t,a){for(var e=0;e<a.length;e++){var s=a[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,a,e){return a&&s(t.prototype,a),e&&s(t,e),t}}();function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function isMobile(){for(var t=navigator.userAgent,a=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],e=!1,s=0;s<a.length;s++)if(0<t.indexOf(a[s])){e=!0;break}var o=window.screen.width,n=window.screen.height;return!e&&o<500&&n<800&&(e=!0),e}!function(h){h.extend({silence:function(t){var a=new s;a.init(t)}});var a={css:"https://unpkg.com/lightbox2@2.11.1/dist/css/lightbox.min.css",js:"https://unpkg.com/lightbox2@2.11.1/dist/js/lightbox.min.js"},e={js:"https://unpkg.com/clipboard@2.0.0/dist/clipboard.min.js"},s=(_createClass(t,[{key:"init",value:function(t){t&&h.extend(!0,this.defaluts,t),this.buildCustomNavigation(),this.buildGithubCorner(),this.buildCopyright(),this.buildBloggerProfile(),this.isPostPage?(this.buildPostCatalog(),this.buildPostCodeCopyBtns(),this.buildPostLightbox(),this.buildPostSignature(),this.buildPostSponsor(),this.buildToolbar(),this.buildPostCommentAvatars()):this.showSideBar()}},{key:"showMessage",value:function(t){h("body").prepend('<div class="esa-layer"><span class="esa-layer-content">'+t+"</span></div>");var a=h(".esa-layer");a.fadeIn(200),setTimeout(function(){a.remove()},2e3)}},{key:"showSideBar",value:function(){767<h(window).width()&&(h(this.cnblogs.forFlow).css({marginLeft:"22em"}),h(this.cnblogs.sideBar).fadeIn(600))}},{key:"buildCustomNavigation",value:function(){var t=this,s=h(this.cnblogs.navList),o=h("body").css("color"),a=this.defaluts.navigation;if(a&&a.length){h.each(a.reverse(),function(t,a){if(a.chilren&&a.chilren.length){var e=a.chilren.map(function(t){return'<li><a class="menu" href="'+t.url+'">'+t.title+"</a></li>"});s.find("li").eq(1).after('\n                            <li class="esa-has-subnavs">\n                                <a class="menu" href="javascript:void(0);">'+a.title+'\n                                    <svg class="arrow" width="12px" height="8px" viewBox="0 0 14 8" xml:space="preserve" fill="none" stroke="'+o+'"><path d="M1,1l6.2,6L13,1"></path></svg>\n                                </a>\n                                <ul class="esa-sub-navs">'+e.join("")+"</ul>\n                            </li>")}else s.find("li").eq(1).after('<li><a class="menu" href="'+a.url+'">'+a.title+"</a></li>")});var e=!1;h(".esa-has-subnavs").on("click",function(){h(".esa-sub-navs").hide(),h(".arrow").removeClass("open"),e=!e&&(h(this).find("svg").addClass("open"),h(this).find("ul").show(),!0)})}h.each(s.children("li"),function(t,a){h(a).append("<i></i>")}),h("body").prepend('<div class="esa-mobile-menu"></div>'),h(".esa-mobile-menu").on("click",function(){h(t.cnblogs.navigator).fadeToggle(200)}),h(this.cnblogs.header).append('\n                <div class="esa-search-box">\n                    <div class="div_my_zzk">\n                        <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk" placeholder="Type to Search">&nbsp;<input onclick="zzk_go()" type="button" value="搜 索" id="btnZzk" class="btn_my_zzk">\n                    </div>\n                </div>'),h(this.cnblogs.navigator).append('\n                <svg t="1573264861612" class="icon esa-search-btn" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7386" width="32" height="32" data-spm-anchor-id="a313x.7781069.0.i8">\n                    <path fill="'+o+'" d="M616.362667 580.608h-23.808l-8.533334-8.128a196.16 196.16 0 1 0-21.098666 21.098667l8.128 8.533333v23.808l150.805333 150.165333 44.8-44.8z m-180.8 0a135.594667 135.594667 0 1 1 135.594666-135.594667 135.402667 135.402667 0 0 1-135.573333 135.594667z" p-id="7387"></path>\n                </svg>'),h(this.cnblogs.navigator).append('\n                <svg t="1573265135257" class="icon esa-search-close" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15367" width="32" height="32">\n                    <path fill="'+o+'" d="M515.23600182 491.06853843L378.27564815 354.10818478a17.09155825 17.09155825 0 1 0-24.17885764 24.15606913l136.96035332 136.97174792-136.96035331 136.97174789a17.09155825 17.09155825 0 1 0 24.16746339 24.16746337l136.97174791-136.96035366 136.9717479 136.96035366a17.09155825 17.09155825 0 1 0 24.16746337-24.15606912l-136.96035366-136.98314215 136.96035366-136.96035367a17.09155825 17.09155825 0 1 0-24.16746337-24.16746337l-136.96035366 136.96035364z" p-id="15368"></path>\n                </svg>');var n=h(".esa-search-box"),i=h(".esa-search-btn"),l=h(".esa-search-close");i.on("click",function(){n.slideDown("fast"),l.show(),i.hide()}),l.on("click",function(){n.slideUp("fast"),l.hide(),i.show()})}},{key:"buildCopyright",value:function(){var t='<span class="esa-copyright">& Theme <a href="https://github.com/esofar/cnblogs-theme-silence" target="_blank">Silence v'+this.version+"</a></span>";h(this.cnblogs.footer).append(t)}},{key:"buildPostSignature",value:function(){var t=this.defaluts.signature;if(t.enable){var a=h(this.cnblogs.postTitle).attr("href"),e='<div class="esa-post-signature"> \n                        <p>作者：'+(t.author||h(this.cnblogs.publicProfile).find("a:eq(0)").html())+'</p> \n                        <p>出处：<a href="'+a+'">'+a+'</a></p> \n                        <p>版权：本文采用「<a href="'+t.link+'"  target="_blank">'+t.license+"</a>」知识共享许可协议进行许可。</p> \n                        <p>"+(t.remark||"")+"</p> \n                    </div>";h(this.cnblogs.postSignature).html(e).show()}}},{key:"buildPostCommentAvatars",value:function(){function t(){h(n.cnblogs.postCommentBody).before("<div class='esa-comment-avatar'><a target='_blank'><img /></a></div>");for(var t=h(n.cnblogs.feedbackContent),a=0;a<t.length;a++){var e="https://pic.cnblogs.com/face/sample_face.gif",s=h(t[a]).find("span:last")[0];s&&(e=h(s).html().replace("http://","//")),h(t[a]).find(".esa-comment-avatar img").attr("src",e);var o=h(t[a]).parent().find(".comment_date").next().attr("href");h(t[a]).find(".esa-comment-avatar a").attr("href",o)}}var n=this;if(h(this.cnblogs.postCommentBody).length)t();else var a=1,e=setInterval(function(){h(n.cnblogs.postCommentBody).length&&(clearInterval(e),t()),10==a&&clearInterval(e),a++},500)}},{key:"buildPostSponsor",value:function(){var a=this.defaluts.sponsor,t=this.defaluts.github,e=this;if(a.enable){h("#blog_post_info").prepend('\n                <div class="esa-sponsor">\n                    <a class="github" href="'+(t.enable?t.link:"https://github.com/Kaiyuan/donate-page")+'" target="_blank" class="posa tr3" title="Github"></a>\n                    <div class="text tr3">'+(a.text||"Sponsor")+'</div>\n                    <ul class="box posa tr3">\n                        <li class="paypal">PayPal</li>\n                        <li class="alipay">AliPay</li>\n                        <li class="wechat">WeChat</li>\n                    </ul>\n                    <div id="QRBox" class="posa left-100">\n                        <div id="MainBox"></div>\n                    </div>\n                </div>');var s=h(".esa-sponsor"),o=h("#QRBox"),n=h("#MainBox");s.find(".box>li").click(function(){var t=h(this).attr("class");if("paypal"===t){if(!a.paypal)return e.showMessage("博主忘记设置 PayPal 收款地址");window.open(a.paypal,"_blank")}else if("alipay"===t){if(!a.alipay)return e.showMessage("博主忘记设置支付宝收款二维码");i(a.alipay)}else if("wechat"===t){if(!a.wechat)return e.showMessage("博主忘记设置微信收款二维码");i(a.wechat)}}),n.click(function(){n.removeClass("showQR").addClass("hideQR"),setTimeout(function(t){o.fadeOut(300,function(){n.removeClass("hideQR")}),s.find(".text, .box, .github").removeClass("blur")},600)})}function i(t){t&&n.css("background-image","url("+t+")"),s.find(".text, .box, .github").addClass("blur"),o.fadeIn(300,function(){n.addClass("showQR")})}}},{key:"buildPostCatalog",value:function(){var l=this.defaluts.catalog;if(l.enable){var t=[l.level1,l.level2,l.level3],a=h(this.cnblogs.postBody).find(t.join(","));if(!a.length)return!1;var e=h('<div class="esa-catalog">\n                        <div class="esa-catalog-contents">\n                            <div class="esa-catalog-title">CONTENTS</div>\n                            <a class="esa-catalog-close">✕</a>\n                        </div>\n                    </div>'),r=0,c=0,d=0,p="<ul>",u=(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(a.length));h.each(a,function(t,a){var e=h(a)[0].tagName.toLowerCase(),s=h(a).text(),o="",n=s;if(l.index)e===l.level1?(d=c=0,o='<span class="level1">'+ ++r+". </span>"):e===l.level2?(d=0,o='<span class="level2">'+r+"."+ ++c+". </span>"):e===l.level3&&(o='<span class="level3">'+r+"."+c+"."+ ++d+". </span>");else switch(e){case l.level1:n='<span class="level1">'+n+"</span>";break;case l.level2:n='<span class="level2">'+n+"</span>";break;case l.level3:n='<span class="level3">'+n+"</span>"}var i=u[t];p+='<li class="li_'+e+'" title="'+s+'">\n                            <i class="'+i+'" ></i><a class="esa-anchor-link">'+(o+n)+"</a>\n                        </li>",h(a).attr("id",""+i).append('<a href="#'+i+'" class="esa-anchor">#</a>').hover(function(){h(a).find(".esa-anchor").css("opacity",1)},function(){h(a).find(".esa-anchor").css("opacity",0)})}),p+="</ul>",e.find(".esa-catalog-contents").append(p),e.appendTo("body");var s=h(".esa-catalog-contents");if(s.fadeIn(),h(".esa-anchor-link").on("click",function(){var t=h("#"+h(this).prev("i").attr("class")).offset().top;h("html, body").animate({scrollTop:t-70},300)}),h(".esa-catalog-close").on("click",function(){s.hide()}),l.move){var i={start:!1,pois:[0,0]};h(".esa-catalog-title").on("mousedown",function(t){t.preventDefault(),i.start=!0;var a=h(".esa-catalog").position(),e=t.clientX-parseFloat(a.left),s=t.clientY-parseFloat(a.top);i.pois=[e,s]}),h(document).on("mousemove",function(t){if(i.start){var a=t.clientX-i.pois[0],e=t.clientY-i.pois[1],s="fixed"===h(".esa-catalog").css("position");t.preventDefault(),i.stX=s?0:h(window).scrollLeft(),i.stY=s?0:h(window).scrollTop();var o=h(window).width()-h(".esa-catalog").outerWidth()+i.stX,n=h(window).height()-h(".esa-catalog").outerHeight()+i.stY;a<i.stX&&(a=i.stX),o<a&&(a=o),e<i.stY&&(e=i.stY),n<e&&(e=n),h(".esa-catalog").css({left:a,top:e,right:"auto"})}}).on("mouseup",function(t){i.start&&(i.start=!1)})}}}},{key:"buildGithubCorner",value:function(){var t=this.defaluts.github;if(t.enable){var a=t.fill?"fill:"+t.fill+";":"";h("body").append('<a href="'+t.link+'" class="github-corner" title="Fork me on GitHub" target="'+t.target+'">\n                        <svg width="60" height="60" viewBox="0 0 250 250" style="'+a+" color:"+t.color+'; z-index: 999; position: fixed; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true">\n                            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>\n                            <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>\n                            <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>\n                        </svg>\n                    </a>')}}},{key:"buildPostCodeCopyBtns",value:function(){var a=this,t=h(".postBody .cnblogs-markdown").find("pre");if(!t.length)return!1;h.each(t,function(t,a){h(a).find("code").attr("id","copy_target_"+t),h(a).prepend('<div data-tips="复制代码" class="esa-clipboard-button" data-clipboard-target="#copy_target_'+t+'">Copy</div>')}),h.getScript(e.js,function(){var t=new ClipboardJS(".esa-clipboard-button");t.on("success",function(t){a.showMessage("代码已复制"),t.clearSelection()}),t.on("error",function(t){a.showMessage("代码复制失败")})})}},{key:"buildToolbar",value:function(){var e=this,t=this.defaluts.catalog;h("body").append('<div class="esa-toolbar">\n                <button class="esa-toolbar-gotop" data-tips="返回顶部"></button>\n                <button class="esa-toolbar-contents" data-tips="阅读目录"></button>\n                <button class="esa-toolbar-follow" data-tips="关注博主"></button>\n                <button class="esa-toolbar-gobottom" data-tips="滑到底部"></button>\n            </div>');var a=h(".esa-toolbar-gotop"),s=h(".esa-toolbar-contents"),o=h(".esa-toolbar-follow"),n=h(".esa-toolbar-gobottom");t.enable?s.on("click",function(){var t=h(".esa-catalog-contents");"none"==t.css("display")?t.fadeIn():t.hide()}):s.remove(),a.on("click",function(){h(window).scrollTop(0)}),h(window).scroll(function(){200<this.scrollY?a.fadeIn():a.fadeOut()}),o.on("click",function(){loadLink(location.protocol+"//common.cnblogs.com/scripts/artDialog/ui-dialog.css",function(){loadScript(location.protocol+"//common.cnblogs.com/scripts/artDialog/dialog-min.js",function(){if(!isLogined)return login();if(c_has_follwed)return e.showMessage("您已经关注过该博主啦");var a=cb_blogUserGuid;h.ajax({url:getAjaxBaseUrl()+"Follow/FollowBlogger.aspx",data:'{"blogUserGuid":"'+a+'"}',dataType:"text",type:"post",contentType:"application/json; charset=utf-8",success:function(t){"未登录"==t?login():"关注成功，请选择分组"==t&&followByGroup(a,!0),e.showMessage(t)}})})})}),n.on("click",function(){document.getElementById("blog_post_info_block")?(h("body,html").animate({scrollTop:h("#blog_post_info_block").offset().top},150),console.log("page is article")):(h("body,html").animate({scrollTop:h("#footer").offset().top},150),console.log("page not article"))})}},{key:"buildBloggerProfile",value:function(){var t=this.defaluts.avatar,a=this.defaluts.favicon;!this.isPostPage&&t&&h(this.cnblogs.sideBarMain).prepend('<img class="esa-profile-avatar" src="'+t+'" />'),a&&h("head").append('<link rel="shortcut icon" href="'+a+'" type="image/x-icon" />')}},{key:"buildPostLightbox",value:function(){var t=this;h("head").append('<link rel="stylesheet" href="'+a.css+'"/>'),h.getScript(a.js,function(){h(t.cnblogs.postBody).find("img").wrap(function(){return'<a href="'+h(this).attr("src")+'" data-title="'+(h(this).attr("title")||"")+'" data-alt="'+(h(this).attr("alt")||"")+'" data-lightbox="roadtrip"></a>'}),h(".code_img_closed, .code_img_opened, .cnblogs_code_copy img").unwrap()})}},{key:"cnblogs",get:function(){return{header:"#header",blogTitle:"#blogTitle",publicProfile:"#profile_block",navigator:"#navigator",navList:"#navList",sideBar:"#sideBar",sideBarMain:"#sideBarMain",forFlow:".forFlow",postTitle:"#cb_post_title_url",postDetail:"#post_detail",postBody:"#cnblogs_post_body",postDigg:"#div_digg",postCommentBody:".blog_comment_body",feedbackContent:".feedbackItem > .feedbackCon",postSignature:"#MySignature",footer:"#footer"}}},{key:"isPostPage",get:function(){return 0<h(this.cnblogs.postDetail).length}}]),t);function t(){_classCallCheck(this,t),this.defaluts={avatar:null,favicon:null,navigation:[],catalog:{enable:!1,move:!0,index:!0,level1:"h2",level2:"h3",level3:"h4"},signature:{enable:!0,author:null,license:"署名-非商业性使用-相同方式共享 4.0 国际",link:"https://creativecommons.org/licenses/by-nc-sa/4.0/",remark:null},sponsor:{enable:!1,text:null,paypal:null,wechat:null,alipay:null},github:{enable:!1,color:"#fff",fill:null,link:null,target:"_self"}},this.version="2.0.2"}}(jQuery);